<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/otp.css">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
    <link rel="stylesheet" href="../assets/dist/css/bootstrap.min.css" />
    <link
      rel="canonical"
      href="https://getbootstrap.com/docs/5.3/examples/headers/"
    />
    <title>Document</title>
  </head>
  <body>
      <h2>Enter OTP</h2>
      <div class="otp-bx">
          <input type="text" maxlength="1">
          <input type="text" maxlength="1">
          <input type="text" maxlength="1" class="space">
          <input type="text" maxlength="1">
          <input type="text" maxlength="1">
          <input type="text" maxlength="1">
      </div>

      <script>
          const inputs = document.querySelectorAll(".otp-bx input");

          inputs.forEach((input, index) => {
              input.dataset.index = index;
              input.addEventListener("paste", handleOtppaste);
              input.addEventListener("keyup", handleOtp);
          });

          function handleOtppaste(e){
              const data = e.clipboardData.getData("text");
              const value = data.split("");
              if(value.length === inputs.length){
                  inputs.forEach((input, index) => (input.value = value[index]));
                  submit();
              }
          }

          function handleOtp(e){
              const input = e.target;
              let value = input.value;
              input.value = "";
              input.value = value ? value[0] : "";

              let fieldIndex = input.dataset.index;
              if(value.length > 0 && fieldIndex < inputs.length - 1){
                  input.nextElementSibling.focus();
              }

              if(e.key === "Backspace" && fieldIndex > 0){
                  input.previousElementSibling.focus();
              }

              if(fieldIndex == inputs.length -1){
                  submit();
              }
          }

          function submit() {
              console.log("Submitting....!");
              let otp = "";
              inputs.forEach((input)=> {
                  otp += input.value;
                  input.disabled = true;
                  input.classList.add("disabled");
              });
              console.log(otp);
          }
      </script>
  </body>
</html>
